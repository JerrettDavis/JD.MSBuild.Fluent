<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <!--Generated by JD.MSBuild.Fluent-->
  <UsingTask TaskName="Contoso.Build.Tasks.ResolveInputs" AssemblyFile="$(_EfcptTaskAssembly)" />
  <UsingTask TaskName="Contoso.Build.Tasks.DetectSqlProject" AssemblyFile="$(_EfcptTaskAssembly)" />
  <Target Name="_EfcptDetectSqlProject" BeforeTargets="BeforeBuild;BeforeRebuild">
    <DetectSqlProject DSP="$(DSP)" ProjectPath="$(MSBuildProjectFullPath)" SqlServerVersion="$(SqlServerVersion)">
      <Output TaskParameter="IsSqlProject" PropertyName="_EfcptIsSqlProject" />
    </DetectSqlProject>
    <PropertyGroup>
      <_EfcptIsSqlProject Condition="'$(_EfcptIsSqlProject)'==''">false</_EfcptIsSqlProject>
    </PropertyGroup>
  </Target>
  <Target Name="EfcptResolveInputs" Condition="'$(EfcptEnabled)' == 'true'">
    <ResolveInputs LogVerbosity="$(EfcptLogVerbosity)" OutputDir="$(EfcptOutput)" ProjectDirectory="$(MSBuildProjectDirectory)">
      <Output TaskParameter="ResolvedConfig" PropertyName="_EfcptResolvedConfig" />
      <Output TaskParameter="ResolvedRenaming" PropertyName="_EfcptResolvedRenaming" />
    </ResolveInputs>
  </Target>
  <Target Name="EfcptStageInputs" DependsOnTargets="EfcptResolveInputs" Inputs="$(EfcptOutput)input.txt" Outputs="$(EfcptOutput)stamp.txt">
    <ItemGroup>
      <_EfcptStagedInputs Include="$(EfcptOutput)**\*" Visible="false" />
    </ItemGroup>
    <Copy DestinationFolder="$(EfcptGeneratedDir)" SourceFiles="@(_EfcptStagedInputs)">
      <Output TaskParameter="CopiedFiles" ItemName="_EfcptCopiedInputs" />
    </Copy>
  </Target>
  <Target Name="EfcptAddToCompile" BeforeTargets="CoreCompile">
    <ItemGroup>
      <Compile Include="$(EfcptGeneratedDir)**\*.g.cs" Condition="'$(EfcptSplitOutputs)' != 'true'" Visible="false" />
      <Compile Include="$(EfcptGeneratedDir)Models\**\*.g.cs" Condition="'$(EfcptSplitOutputs)' == 'true'" Visible="false" />
      <_EfcptDbContextFiles Include="$(EfcptGeneratedDir)*.g.cs" Exclude="$(EfcptGeneratedDir)*Configuration.g.cs" />
    </ItemGroup>
  </Target>
</Project>
